!function(){"use strict";function e(e,o,t,n,a,i,s,c,l,r,f,u,m,d,g,v,h,w,p){var b=o.vm={};b.followBadge=0,b.IMInterfaceService=h;var I=p.getNoticeMessageTypes(),_=function(){var e=g.cache;e.nm_follow_changed&&(e.nm_follow_changed=!1,b.followBadge=e.nm_follow.length),1==b.activeTab&&0==b.self.tabFollow&&(w.setReadFlagByType(I.FRIEND_TASK_MESSAGE_TYPE),e.nm_follow=[],e.nm_main_changed=!0,b.followBadge=0)};b.meInfo={},b.meInfo.cb_avatar=function(){console.log("me avatar")},o.$on("$ionicView.beforeEnter",function(){var e=l.cache.selfInfo;b.meInfo.remoteData=e,b.meInfo.ui_tags=[],r.netTagsToUiTags(b.meInfo.ui_tags,e.tags),s(function(){o.$apply()});var t=l.cache.selfInfo.attentionList;for(var n in t)f.uiProcessFollow(t[n]);t=l.cache.selfInfo.funsList;for(var n in t)f.uiProcessFollowed(t[n]);v.add(0,"me.controller",_)}),o.$on("$ionicView.leave",function(){v.remove(0,"me.controller",_)}),b.cb_edit=function(){e.go("main.edit")},b.cb_setting=function(){e.go("main.setting")},b.cb_share=function(){m.shareApp()},b.cb_im=function(){e.go("main.im")},b.meInfo.accessUserAvatar=function(e){if(ho.isValid(b.meInfo.remoteData)){var o=b.meInfo.remoteData.accessUserList.length;return e<o?b.meInfo.remoteData.accessUserList[e].avatar:""}return""},b.meScroll=a.$getByHandle("meScroll"),b.activeTab=0,b.onChangeTab=function(e){s(function(){b.meScroll.resize()},300),0==e&&(b.self.repeatList=[]),console.log("xxx"+ho.trace(b.self.repeatList)),b.activeTab=0==e?0:1};var L=b.self={};L.fiveStarsValue=2.5,L.level=25,L.hasExp=1389,L.totalExp=2320,L.smallCards=10,L.bigCards=20,L.cb_visitorImg=function(e){console.log("click on image ["+e+"]");var o=b.meInfo.remoteData.accessUserList[e];f.gotoUser(o.userId,"me")},L.tabFollow=0,L.ui_showFriendList=!0,L.cb_gotoUser=function(e){f.gotoUser(e,"me")},L.cb_tabFollow=function(e){0==e?b.self.repeatList=l.cache.selfInfo.attentionList:b.self.repeatList=l.cache.selfInfo.funsList,L.tabFollow=e},L.cb_follow=function(e){var o=b.self.repeatList[e];t.show(),l.attention(o.userId).then(function(n){t.hide(),t.show({duration:1500,templateUrl:"modules/components/templates/ionic-loading/user-follow-success.html"}),o=n.data,b.self.repeatList[e]=o;var a=ho.clone(o);f.uiProcessFollow(a),l.cache.selfInfo.attentionList.splice(0,0,a),f.uiProcessFollowed(o)},function(e){t.hide(),ho.alertObject(e)})["finally"](function(){})},L.cb_postList=function(o){var t=b.self.repeatList[o];d.user={id:t.userId,nickname:t.nickname},d.tasks=[],e.go("main.me_user-tasks")},L.cb_cancelFocus=function(e){i.show({titleText:"真的要取消关注么",buttons:[{text:"<b>是</b>"},{text:"<b>否</b>"}],buttonClicked:function(o){if(0==o){var n=b.self.repeatList[e];t.show(),l.unattention(n.userId).then(function(o){if(t.hide(),t.show({duration:1500,templateUrl:"modules/components/templates/ionic-loading/com-cancel-success.html"}),n.isMutualAttention){var a=l.cache.selfInfo.funsList;for(var i in a)if(a[i].userId==n.userId){a[i].isMutualAttention=!1,f.uiProcessFollowed(a[i]);break}}l.cache.selfInfo.attentionList.splice(e,1)},function(e){t.hide(),ho.alertObject(e)})["finally"](function(){})}return!0},cancelText:"取消",cancel:function(){},destructiveButtonClicked:function(){}})},L.friendList=[{name:"小刚",desc:"华中科技大学 光电子系",follow:!1},{name:"小刚",desc:"华中科技大学 光电子系",follow:!0},{name:"小刚",desc:"华中科技大学 光电子系",follow:!0},{name:"小刚",desc:"华中科技大学 光电子系",follow:!1},{name:"小刚",desc:"华中科技大学 光电子系",follow:!1},{name:"小刚",desc:"华中科技大学 光电子系",follow:!1},{name:"小刚",desc:"华中科技大学 光电子系",follow:!0},{name:"小刚",desc:"华中科技大学 光电子系",follow:!0},{name:"小刚",desc:"华中科技大学 光电子系",follow:!1},{name:"小刚",desc:"华中科技大学 光电子系",follow:!1}],L.repeatList=[]}angular.module("main.me").controller("mainMeCtrl",["$state","$scope","$ionicLoading","$ionicPopup","$ionicScrollDelegate","$ionicActionSheet","$timeout","$interval","userNetService","impressUtils","userUtils","errorCodeService","SharePageWrapService","mainUserTasksService","taskNetService","intervalCenter","IMInterfaceService","NoticeMessageDB","NoticeMessageService",e])}();